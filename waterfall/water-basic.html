<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
        .content{
            position: relative;
        }
        .item{
            position: absolute;
            width: 200px;
            margin-right: 10px;
            margin-top: 10px;
            transition: all 1s;
        }
        .h1{
            height: 200px;
            background-color: #f4b300;
        }
        .h2{
            height: 300px;
            background-color: #691bb8;
        }
        .h3{
            height: 400px;
            background-color: #006ac1;
        }
    </style>
    <script src="http://libs.baidu.com/jquery/1.9.0/jquery.js"></script>
    <script>
        $(function(){

            //功能实现
            
            // function render(){

            //     var nodeWidth = $('.item').outerWidth(true),
            //         colNum = parseInt($(window).width()/nodeWidth),
            //         colSumHeight = [];

            //     for(var i = 0, len = colNum; i < len; i++){
            //         colSumHeight.push(0);
            //     }

            //     $('.item').each(function(){
            //         var $cur = $(this);
            //         //colSumHeight = [100,230,150,115]
                    
            //         var idx = 0,
            //             minSumHeight = colSumHeight[0];

            //         for(var i = 0, len = colSumHeight.length; i < len; i++){
            //             if(colSumHeight[i] < minSumHeight){
            //                 idx = i;
            //                 minSumHeight = colSumHeight[i];
            //             }
            //         }

            //         $cur.css({
            //             left: nodeWidth * idx,
            //             top: minSumHeight
            //         });
            //         colSumHeight[idx] = $cur.outerHeight(true) + colSumHeight[idx];
            //     });
            // }

            // render();

            // $(window).on('resize', function(){
            //     render();
            // })



            // 简单封装

            var water = (function($){

                    function render(){
                        var nodeWidth = $('.item').outerWidth(true),
                            colNum = parseInt($(window).width()/nodeWidth),
                            colSumHeight = [];

                        for(var i = 0, len = colNum; i < len; i++){
                            colSumHeight.push(0);
                        }

                        $('.item').each(function(){
                            var $cur = $(this);
                            //colSumHeight = [100,230,150,115]
                            
                            var idx = 0,
                                minSumHeight = colSumHeight[0];

                            for(var i = 0, len = colSumHeight.length; i < len; i++){
                                if(colSumHeight[i] < minSumHeight){
                                    idx = i;
                                    minSumHeight = colSumHeight[i];
                                }
                            }

                            $cur.css({
                                left: nodeWidth * idx,
                                top: minSumHeight
                            });
                            colSumHeight[idx] = $cur.outerHeight(true) + colSumHeight[idx];
                        });                        
                    }
                    render();
                    $(window).on('resize',function(){
                        render();
                    })

                    return {
                        init: render
                    }
            })(jQuery)

            water.init();

        });

    </script>
</head>
<body>
    <div class="contnet">
        <div class="item h1">1</div>
        <div class="item h3">2</div>
        <div class="item h2">3</div>
        <div class="item h1">4</div>
        <div class="item h1">5</div>
        <div class="item h3">6</div>
        <div class="item h3">7</div>
        <div class="item h2">8</div>
        <div class="item h1">9</div>
        <div class="item h3">10</div>
        <div class="item h3">11</div>
        <div class="item h2">12</div>
        <div class="item h1">13</div>
        <div class="item h2">14</div>
    </div>
</body>
</html>